---
title: "The shape of things to come"
subtitle: "Topological Data Analysis and Plant Biology"
author: "**Erik Amézquita** <br> &mdash; <br> Computational Mathematics, Science, and Engineering <br> Michigan State University <br> &mdash;"
date: "2022-11-30 <br> &mdash; <br> Slides available @ [bit.ly/mu_22](https://bit.ly/mu_22)"
output:
  xaringan::moon_reader:
    css: ["../../css/msu.css", default-fonts, "../../css/gallery.css"]
    chakra: '../../js/remark-latest.min.js'
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
    seal: false

---

```{r setup, include=FALSE}
library(reticulate)
library(knitr)

options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(fig.align = 'center')
```

background-image: url("../../psd/figs/mizzou22.png")
background-size: 200px
background-position: 98% 93%

class: inverse, middle

<style>
.title-slide .remark-slide-number {
  display: none;
}
</style>

<p style="font-size: 72px; text-align: center; color: White; font-family: 'Yanone Kaffeesatz'">The shape of things to come</p>
<p style="font-size: 56px; text-align: center; color: Cornsilk; font-family: 'Yanone Kaffeesatz'">Topological Data Analysis and Plant Biology</p>
<p style="font-size: 2px; text-align: left; color: Green; font-family: 'Yanone Kaffeesatz'">.</p>
<p style="font-size: 48px; text-align: left; color: White; font-family: 'Yanone Kaffeesatz'">Erik Amézquita</p>
<p style="font-size: 36px; text-align: left; color: White; font-family: 'Yanone Kaffeesatz'">Computational Mathematics, Science, and Engineering</p>
<p style="font-size: 36px; text-align: left; color: White; font-family: 'Yanone Kaffeesatz'">Michigan State University</p>
<p style="font-size: 36px; text-align: left; color: Cornsilk; font-family: 'Yanone Kaffeesatz'">Slides available @ <a href="http://egr.msu.edu/~amezqui3/barley/slides/mizzou_2022.html">bit.ly/mu_22</a></p>
<p style="padding-left:475px; font-size: 36px; text-align: left; color: Cornsilk; font-family: 'Yanone Kaffeesatz'">Slides QR &rarr;</p>

<a href="https://github.com/amezqui3/demeter" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#151513; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

<a href="https://www.egr.msu.edu/~amezqui3/index.html" target="_blank"><img src="../../img/web_ribbon.svg" style="position: absolute; top: 0; left: 0; border: 0;"></a>


---

background-image: url("../../img/endlessforms.png")
background-size: 150px
background-position: 89% 7%

class: inverse

# Plant morphology

<div class="row">
  <div class="column" style="max-width:50%">
    <iframe width="375" height="210" src="https://www.youtube-nocookie.com/embed/oM9kAq0PBvw?controls=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <iframe width="375" height="210" src="https://www.youtube-nocookie.com/embed/V39K58evWlU?controls=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </div>
  <div class="column" style="max-width:50%">
    <iframe width="375" height="210" src="https://www.youtube-nocookie.com/embed/4GBgPIEDoa0?controls=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <iframe width="375" height="210" src="https://www.youtube-nocookie.com/embed/qkOjHHuoUhA?controls=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </div>
</div>
<p style="font-size: 24px; text-align: right; font-family: 'Yanone Kaffeesatz'">Check out more 3D X-ray CT scans at <a href="https://www.youtube.com/@endlessforms6756">youtube.com/@endlessforms6756</a></p>

---

# Topological Data Analysis (TDA)

<div class="row" style="font-family: 'Yanone Kaffeesatz'">
  <div class="column" style="max-width:25%; font-size: 20px;">
    <img style="padding: 25px 0 35px 0;" src="../figs/S019_L0_1.gif">
    <p style="font-size: 30px; text-align: center; color: DarkRed;"> Raw Data </p>
    <ul>
      <li> X-ray CT </li>
      <li> Point clouds </li>
      <li> Time series </li>
    <ul>
  </div>
  <div class="column" style="max-width:40%; padding: 0 25px 0 25px; font-size: 20px;">
    <img src="../figs/ecc_X.gif">
    <p style="font-size: 28px; text-align: center; color: DarkRed;"> Topological Summary </p>
    <ul>
      <li> Euler Characteristic </li>
      <li> Persistence diagrams </li>
      <li> Mapper/Reeb graphs </li>
    <ul>
  </div>
  <div class="column" style="max-width:35%; font-size: 20px;">
    <img src="../figs/svm_mds_ect.gif">
    <p style="font-size: 30px; text-align: center; color: DarkRed;"> Analysis </p>
    <ul>
      <li> Statistics </li>
      <li> Machine learning </li>
      <li> Classification/prediction </li>
    <ul>
  </div>
</div>

---

background-image: url("../../demat/figs/fam9_3.png")
background-size: 100px
background-position: 98% 2%

## I work across multiple disciplines and countries

.left-column[

![](../../img/aboutmelogos.png)

]

.right-column[

- 2009 - 2013 : Participant and later Tutor for the **Guatemalan** Math Olympiad Team

- 2010 - 2012 : UWC Alum. A boarding high school student in an international experiment in Pune, **India**.

- 2013 - 2018 : Studied mathematics at the Universidad de Guanajuato and CIMAT, in Guanajuato, **Mexico**.

- 2016 - 2018 : Bachelor thesis: **Math + Archaeology**. Use TDA to quantify and classify the shape of pre-Columbian masks found in the Templo Mayor in Mexico City

]

&mdash;&mdash;&mdash;&mdash;&mdash;

<div class="row">
  <div class="column" style="max-width:15%">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0005_0001.png">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0010_0001.png">
  </div>
  <div class="column" style="max-width:11%">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0011_0001.png">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0020_0001.png">
  </div>
    <div class="column" style="max-width:12%">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0024_0001.png">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0027_0001.png">
  </div>
    <div class="column" style="max-width:12%">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0030_0001.png">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0045_0001.png">
  </div>
    <div class="column" style="max-width:11.5%">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0036_0001.png">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0081_0001.png">
  </div>
    <div class="column" style="max-width:11.5%">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0043_0001.png">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0047_0001.png">
  </div>
    <div class="column" style="max-width:11%">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0048_0001.png">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0056_0001.png">
  </div>
    <div class="column" style="max-width:12%">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0064_0001.png">
    <img style="padding: 0 0 0 0;" src="../../demat/figs/0CII_0079_0001.png">
  </div>
</div>

---

background-image: url("../../cmse/figs/cmse logo file-01.svg")
background-size: 150px
background-position: 1% 50%

class: center

# My research: Crossing and merging bridges

<div class="row">
  <div class="column" style="width:15%">
  </div>
  <div class="column" style="max-width:15%">
    <a href="https://doi.org/10.1093/insilicoplants/diab033" target="_blank"><img style="padding: 0 0 0 0;" src="../figs/S017_L3_1.gif"></a>
  </div>
  <div class="column" style="max-width:18%">
    <a href="https://doi.org/10.1002/ppp3.10333" target="_blank"><img style="padding: 0 0 0 0;" src="../../citrus/figs/SR01_L01_black_exocarp.gif"></a>
  </div>
  <div class="column" style="max-width:25%">
    <img style="padding: 0 0 0 0;" src="../../arabidopsis/figs/Day7_110921_U112-3_pot0_leaf_X.gif">
  </div>
  <div class="column" style="max-width:25%">
    <img style="padding: 0 0 0 0;" src="../../walnuts/figs/2014SBa_R5_T81_meat_2.gif">
  </div>
</div>

<div class="row">
  <div class="column" style="width:15%">
  </div>
  <div class="column" style="max-width:28%">
    <a href="https://plantsandpython.github.io/PlantsAndPython/00_Opening_page.html" target="_blank"><img style="padding: 0 0 0 0;" src="../../tutorials/figs/plants_and_python_group_photo.jpg"></a>
  </div>
  <div class="column" style="max-width:60%">
    <a href="https://doi.org/10.1101/2022.10.15.512190" target="_blank"><img style="padding: 0 0 0 0;" src="../../journal_diversity/figs/frequencies_globe_inv.jpg"></a>
  </div>
</div>

<div class="list" style="font-size: 10px; text-align: left;">
    <ul>
      <li>R.A. Marks <em>et al.</em> (2022) Global disparities in plant science: a legacy of colonialism, patriarchy, and exclusion. DOI: <a href="https://doi.org/10.1101/2022.10.15.512190" target="_blank">10.1101/2022.10.15.512190</a></li>
        <li><strong>E.A.</strong> <em>et al.</em> (2022) The shape of aroma: measuring and modeling citrus oil gland distribution. <a href="https://doi.org/10.1002/ppp3.10333" target="_blank">DOI: 10.1002/ppp3.10333</a></li>
        <li>R. VanBuren <em>et al.</em> (2022) Teaching Tools in Plant Biology. Plants and Python, Coding from Scratch in the Plant Sciences. <a href="https://doi.org/10.1093/plcell/koac187" target="_blank">DOI: 10.1093/plcell/koac187</a>.</li>
        <li><strong>E.A.</strong> <em>et al.</em> (2021) Measuring hidden phenotype: Quantifying the shape of barley seeds using the Euler Characteristic Transform. <a href="https://doi.org/10.1093/insilicoplants/diab033" target="_blank">DOI: 10.1093/insilicoplants/diab033</a></li>
    </ul>
</div>

---

background-image: url("../figs/seed.png")
background-size: 325px
background-position: 99% 99%

# Roadmap for today

### Split into modules

1. Survey of TDA in biology applications

1. The Euler Characteristic Transform and barley morphology

1. Modeling citrus oil glands with directional statistics

1. Potential projects and Plants&Python

---

class: inverse, middle, center

# 1. TDA meets biology in a number of ways

## Shape is data and data is shape

### The significance of detecting connected components and holes

---

# 1st TDA Ingredient: Complexes

- Think the data as a collection of elementary building blocks ( _cells_ )

Vertices | Edges | Faces | Cubes
---------|-------|-------|-------
  0-dim  | 1-dim | 2-dim | 3-dim

- A collection of cells is a _cubical complex_

- Count the number of topological features ( _holes_ ):

Connected components | Loops | Voids
---------------------|-------|-------
       0-dim         | 1-dim | 2-dim

- Example with 2 connected components, 1 loop, 0 voids

```{r, out.width=500}
knitr::include_graphics("../../tda/figs/binary_to_cubical_complex_textless.svg")
```

---

# 2nd TDA Ingredient: Filters

- Each cell is assigned a real value which defines how the complex is constructed.

- Observe how the number of topological features change as the complex grows.

.pull-left[
```{r, out.width="250px"}
knitr::include_graphics(c("../figs/eigcurv_filter.gif", "../figs/gaussian_density_filter.gif"))
```
]

.pull-right[
```{r, out.width="250px"}
knitr::include_graphics(c("../figs/eccentricity_filter.gif", "../figs/vrips_ver2.gif"))
```
]

---

# TDA + Biology in the literature

<div class="row">
  <div class="column" style="max-width:25%">
    <img style="padding: 0 0 0 0;" src="https://ars.els-cdn.com/content/image/1-s2.0-S1361841518302688-gr1.jpg">
    <img style="padding: 0 0 0 0;" src="https://ars.els-cdn.com/content/image/1-s2.0-S1361841518302688-gr2.jpg">
    <p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1016/j.media.2019.03.014">Qaiser <em>et al.</em> (2019)</a></p>
  </div>
  <div class="column" style="max-width:25%">
    <img style="padding: 0 0 0 0;" src="https://www.pnas.org/cms/10.1073/pnas.1313480110/asset/ce30e9df-d595-4520-a68a-74f3c6f151d1/assets/graphic/pnas.1313480110fig01.jpeg">
    <img style="padding: 0 0 0 0;" src="https://www.pnas.org/cms/10.1073/pnas.1313480110/asset/b733c3a3-00f2-43d5-b372-9da25f3d33c9/assets/graphic/pnas.1313480110fig02.jpeg">
    <p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1073/pnas.1313480110">Chan <em>et al.</em> (2013)</a></p>
  </div>
  <div class="column" style="max-width:22%">
    <img style="padding: 0 0 0 0;" src="https://www.degruyter.com/document/doi/10.1515/sagmb-2015-0057/asset/graphic/j_sagmb-2015-0057_fig_001.jpg">
    <img style="padding: 0 0 0 0;" src="https://www.degruyter.com/document/doi/10.1515/sagmb-2015-0057/asset/graphic/j_sagmb-2015-0057_fig_012.jpg">
    <img style="padding: 0 0 0 0;" src="https://www.degruyter.com/document/doi/10.1515/sagmb-2015-0057/asset/graphic/j_sagmb-2015-0057_fig_010.jpg">
    <p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1515/sagmb-2015-0057">Kovacev-Nikolic <em>et al.</em> (2016)</a></p>
  </div>
  <div class="column" style="max-width:28%">
    <img style="padding: 0 0 0 0;" src="https://media.springernature.com/original/springer-static/image/chp%3A10.1007%2F978-3-030-20867-7_7/MediaObjects/484957_1_En_7_Fig1_HTML.png">
    <p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1007/978-3-030-20867-7_7">Chitwood <em>et al.</em> (2019)</a></p>
  </div>
</div>

<div class="row" style="font-family: 'Yanone Kaffeesatz'; font-size:25px;">
  <div class="column" style="width:25%;">
    <p style="text-align: center;">Holes</p>
    <p style="text-align: center;">&darr;</p>
    <p style="text-align: center;">Cancerous tissue</p>
  </div>
  <div class="column" style="width:25%;">
    <p style="text-align: center;">Holes</p>
    <p style="text-align: center;">&darr;</p>
    <p style="text-align: center;">Horizontal Reassortment</p>
  </div>
  <div class="column" style="width:25%;">
    <p style="text-align: center;">Holes</p>
    <p style="text-align: center;">&darr;</p>
    <p style="text-align: center;">Open/closed conformations</p>
  </div>
  <div class="column" style="width:25%;">
    <p style="text-align: center;">Components</p>
    <p style="text-align: center;">&darr;</p>
    <p style="text-align: center;">Panicle structure</p>
  </div>
</div>

---

# Advertisement

- More content, references, and examples

> Amézquita _et al._ (2020) "The shape of things to come: Topological data analysis and biology, from molecules to organisms". _Developmental Dynamics_ **249**(7) pp. 816-833. DOI: [10.1002/dvdy.175](https://doi.org/10.1002/dvdy.175)

![](../../tda/figs/amezquita_etal_2020.png)

---

class: inverse, middle, center

# 2. Focusing on the Euler Characteristic

## The Euler Characteristic Transform (ECT)

---

# Topology: The Euler characteristic $\chi$

$$\chi = \#(\text{Vertices}) - \#(\text{Edges}) + \#(\text{Faces}).$$

<div class="row">
  <div class="column" style="width:5%">
  </div>
  <div class="column" style="max-width:30%">
    <img style="padding: 0 0 0 0;" src="../../tda/figs/tetrahedron.gif">
  </div>
  <div class="column" style="max-width:30%">
    <img style="padding: 0 0 0 0;" src="../../tda/figs/cube.gif">
  </div>
  <div class="column" style="max-width:30%">
    <img style="padding: 0 0 0 0;" src="../../tda/figs/octahedron.gif">
  </div>
  <div class="column" style="width:5%">
  </div>
</div>

<div class="row">
  <div class="column" style="width:5%">
  </div>
  <div class="column" style="max-width:30%">
    <img style="padding: 0 0 0 0;" src="../../tda/figs/dodecahedron.gif">
  </div>
  <div class="column" style="max-width:30%">
    <img style="padding: 0 0 0 0;" src="../../tda/figs/icosahedron.gif">
  </div>
  <div class="column" style="max-width:30%">
    <p style="padding: 50px 0 0 10px; font-size: 48px; text-align: center; color: #18453B; line-height: 1.25; font-family: 'Yanone Kaffeesatz';"> V - E + F = 2</p>
  </div>
  <div class="column" style="width:5%">
  </div>
</div>

---

background-image: url("../figs/ecc_ver2.gif")
background-size: 750px
background-position: 50% 90%

# Euler Characteristic Curve (ECC)

- Consider a cubical complex $X\subset\mathbb{R}^d$
- And a unit-length direction $\nu\in S^{d-1}$

- And the subcomplex containing all cubical cells below height $h$ in the direction $\nu$
$$X(\nu)_h =\{\Delta \in X\::\:\langle x,\nu\rangle\leq h\text{ for all }x\in\Delta\}$$

- The Euler Characteristic Curve (ECC) of direction $\nu$ is defined as the sequence $$\{\chi(X(\nu)_h)\}_{h\in\mathbb{R}}$$
---

background-image: url("../figs/ect_ver2.gif")
background-size: 800px
background-position: 50% 88%

## Euler Characteristic Transform (ECT)

- Repeat and concatenate for all possible directions.

$$
\begin{split}
ECT(X):\; & S^{d-1} \to \mathbb{Z}^{\mathbb{R}}\\
&\nu\mapsto\{\chi(X(\nu)_h)\}_{h\in\mathbb{R}}.
\end{split}
$$

- [**Theorem** (Turner, Mukherjee, Boyer 2014) & (Curry, Mukherjee, Turner, 2018)](http://arxiv.org/abs/1805.09782):  The ECT is injective with a finite bound of necessary directions.

---

background-image: url("../figs/turner_etal_2014.png")
background-size: 280px
background-position: 99% 1%


# More on the ECT

- Easy to compute: a quick alternating sum.

- *Different* simplicial complexes correspond to *different* ECTs.

- [**Theorem _(ibid)_**](https://arxiv.org/abs/1310.1030): The ECT effectively summarizes all possible information related to shape.

There is elusive math research on computationally efficient reconstruction algorithms:
- [Turner, Mukherjee, Curry (2021)](https://arxiv.org/abs/1805.09782): Finite number of directions
- [Betthauser (2018)](https://people.clas.ufl.edu/peterbubenik/files/Betthauser_Thesis.pdf): 2D reconstruction
- [Fasy, Micka, Millman, Schenfisch, Williams (2022)](https://arxiv.org/abs/1912.12759): 3D reconstruction
- [Crawford, Monod, Chen, Mukherjee, Rabadan (2020)](https://doi.org/10.1080/01621459.2019.1671198): Smooth ECT
- [Jiang, Kurtek, Needham (2020)](https://openaccess.thecvf.com/content_CVPRW_2020/papers/w50/Jiang_The_Weighted_Euler_Curve_Transform_for_Shape_and_Image_Analysis_CVPRW_2020_paper.pdf): Weighted ECT

```{r, out.width="500px"}
knitr::include_graphics(c("../../arabidopsis/figs/ect_col-0_pot0_leaf0.gif"))
```
![]()

---

background-image: url("../figs/amezquita_etal_2021.png")
background-size: 400px
background-position: 50% 95%

class: inverse, middle, center

# Quantifying barley morphology

## Using the Euler Characteristic Transform

---

<div class="row">
  <div class="column" style="max-width:44%">
    <a href="https://cereal.interreg-npa.eu/subsites/CEREAL/Barley_cultivation-Norway_Presentation_2018.pdf" target="_blank"><img style="padding: 0 0 0 0;" src="../figs/barley_norway.jpg"></a>
    <a href="https://www.resilience.org/stories/2020-03-09/the-last-crop-before-the-desert/" target="_blank"><img style="padding: 0 0 0 0;" src="../figs/barley_morocco.jpg"></a>
    <a href="https://www.doi.org/10.1007/978-1-4419-0465-2_2168" target="_blank"><img style="padding: 0 0 0 0;" src="../figs/barley_world.jpg"></a>
  </div>
  <div class="column" style="max-width:44%">
    <a href="https://doi.org/10.2134/agronj1929.00021962002100040014x" target="_blank"><img style="padding: 0 0 0 0;" src="../figs/composite_cross_v_05.svg"></a>
    <div class="row">
      <div class="column" style="max-width:46%">
        <img src="../figs/S019_L0_1.gif">
      </div>
      <div class="column" style="max-width:55%">
        <img src="../figs/S017_L0_seed_10_0.gif">
      </div>
    </div>
  </div>
  <div class="column" style="max-width:8%; font-size: 15px;">
    <p style="text-align: center; font-size: 30px; line-height: 1em; color: #18453B;"> <strong> Barley from across the world </strong></p>
    <p>28 collected barley varieties</p>
    <p>Brought to California in 1929</p>
    <p>Artificial evolution experiment for 58 generations</p>
    <p>975 panicles scanned</p>
    <p>38,000 seeds isolated</p>
  </div>
</div>

---

background-image: url("../figs/S017_L0_seed_10_0.gif")
background-size: 85px
background-position: 90% 2%

# Traditional shape descriptors

<div class="row">
  <div class="column" style="max-width:55%">
    <img style="padding: 0 0 0 0;" src="../figs/boxplot_founders_Length.png">
    <img style="padding: 0 0 0 0;" src="../figs/boxplot_founders_Area.png">
  </div>
  <div class="column" style="max-width:45%">
    <img style="padding: 0 0 0 0;" src="../figs/boxplot_all_vol_h.png">
    <img style="padding: 0 0 0 0;" src="../figs/boxplot_all_length_h.png">
    <img style="padding: 0 0 0 0;" src="../figs/boxplot_all_area_h.png">
  </div>
</div>

---

background-image: url("../figs/ect_ver2.gif")
background-size: 600px
background-position: 50% 98%

# Topological shape descriptors

.pull-left[
```{r, out.width=250}
knitr::include_graphics('../figs/pole_directions_p7_m12_crop.jpg')
```
]

.pull-right[
- 158 directions

- 16 slices per direction

- Every seed is associated a $158\times16=2528$-dim vector

- Reduced to 12 dimensions with UMAP
]


---

# Supervised Learning

![](../../demat/figs/supervised_learning.png)

---

# Quantify the shape of barley

**Goal:** Classify the **28** founding barley varieties solely by grain morphology information.

<style type="text/css">
.tg  {border-collapse:collapse;border-color:#93a1a1;border-spacing:0;margin:0px auto;}
.tg td{background-color:#fdf6e3;border-bottom-width:1px;border-color:#93a1a1;border-style:solid;border-top-width:1px;
  border-width:0px;color:#002b36;font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;
  word-break:normal;}
.tg th{background-color:#657b83;border-bottom-width:1px;border-color:#93a1a1;border-style:solid;border-top-width:1px;
  border-width:0px;color:#fdf6e3;font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;
  padding:10px 5px;word-break:normal;}
.tg .tg-2bhk{background-color:#eee8d5;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-gyvr{background-color:#eee8d5;border-color:inherit;font-size:100%;text-align:left;vertical-align:top}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-0pky">Shape descriptors</th>
    <th class="tg-0pky">No. of descriptors</th>
    <th class="tg-0pky">F1</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-2bhk">Traditional</td>
    <td class="tg-2bhk">11</td>
    <td class="tg-2bhk">0.55 &plusmn; 0.019</td>
  </tr>
  <tr>
    <td class="tg-0pky">Topological</td>
    <td class="tg-0pky">12</td>
    <td class="tg-0pky">0.74 &plusmn; 0.016</td>
  </tr>
  <tr>
    <td class="tg-2bhk">Combined</td>
    <td class="tg-2bhk">23</td>
    <td class="tg-2bhk"><strong>0.86 &plusmn; 0.010</strong></td>
  </tr>
</tbody>
</table>

### What does topology actually measure?

.pull-left[
```{r, out.width=225}
knitr::include_graphics(c('../figs/discerning_directions.png'))#, '../figs/arrow_seed_09_0.gif'))
```
]

.pull-right[
![](../figs/arrow_seed_09_0.gif)
]

---

# Predicting with Semi-Supervised Learning

![](../../demat/figs/semisupervised_learning.png)

---

# Prediction into semi-supervised territory

- Train an SVM with 100% of the founders $(F_0)$

- Classify the progeny $(F_{18}\text{ and }F_{58})$ to detect genotype enrichment

.pull-left[
![](../figs/histogram_combined_gen0_d158_T16_topounscaled_vert.svg)
]

.pull-right[
![](../figs/histogram_combined_gen7_d158_T16_topounscaled_vert.svg)
]

---

background-image: url("../figs/comparison_lines_combined_topounscaled_d158_T16_horz.png")
background-size: 900px
background-position: 50% 70%

## Observe shape distribution across lines

---


# Future directions

.left-column[
![](../figs/seeds_batch2_2_transp.png)
![](../figs/seeds_batch2_3_transp.png)
]

.right-column[
- Identify specific molecular markers corresponding to morphological differences across the diverse barley population.

- Develop a high-throughput pipeline to produce 3D images of individual barley seeds and quantify comprehensively their morphology.

- Formalize a method for promising seedling selection to further crop breeeding.

- Extend such pipeline and population genetics studies to other crops and grains.
]

---

background-image: url("../../citrus/figs/ppp3.png")
background-size: 400px
background-position: 50% 90%

class: center, inverse, middle

# 3. If life gives you lemons...

## Modeling citrus oil gland distribution

---

## Think of citrus as lego blocks

![](../../citrus/figs/citrus_family_tree_1.jpg)
<p style="font-size: 8px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1038/nature25447">Wu <em>et al.</em> (2018)</a></p>

---

## Raw Data: X-rays &rarr; Image Processing

<div class="row">
  <div class="column" style="max-width:38%; color: Navy; font-size: 15px;">
    <img style="padding: 2px 0 2px 0;" src="../../citrus/crc_pics/crc_diversity.jpg">
    <p style="text-align: center;"> UCR Collaboration </p>
  </div>
  <div class="column" style="max-width:38%; color: Navy; font-size: 15px;">
    <img style="padding: 2px 0 2px 0;" src="../../citrus/crc_pics/citrus_xrayct_scanning.jpeg">
    <p style="text-align: center;"> 3D X-Ray CT scan </p>
  </div>
  <div class="column" style="max-width:23%; color: Navy; font-size: 15px;">
    <img src="../../citrus/figs/SR01_CRC3289_12B-19-9_L01_raw.gif">
    <p style="text-align: center;"> Raw </p>
  </div>
</div>

<div class="row" style="margin: 0 auto;">
  <div class="column" style="max-width:20%; color: Navy; font-size: 15px;">
    <img src="../../citrus/figs/SR01_L01_black_spine.gif">
    <p style="text-align: center;"> Spine </p>
  </div>
  <div class="column" style="max-width:20%; color: Navy; font-size: 15px;">
    <img src="../../citrus/figs/SR01_L01_black_endocarp.gif">
    <p style="text-align: center;"> Endocarp </p>
  </div>
  <div class="column" style="max-width:20%; color: Navy; font-size: 15px;">
    <img src="../../citrus/figs/SR01_L01_black_rind.gif">
    <p style="text-align: center;"> Rind </p>
  </div>
  <div class="column" style="max-width:20%; color: Navy; font-size: 15px;">
    <img src="../../citrus/figs/SR01_L01_black_exocarp.gif">
    <p style="text-align: center;"> Exocarp </p>
  </div>
  <div class="column" style="max-width:20%; color: Navy; font-size: 15px;">
    <img src="../../citrus/figs/SR01_L01_black_oil_glands.gif">
    <p style="text-align: center;"> Oil glands</p>
  </div>
</div>

---


## Size and average distance between closest oil glands

![](../../citrus/figs/knn01_panel.svg)

- Smaller fruits report higher density of oil glands
- Similar results when looking at the average distance between each oil gland and its 2nd, 3rd, ..., 25th nearest neighbors

---

## Average distance from each gland to its $k$-th nearest neighbor

![](../../citrus/figs/panel_knn25_growth.svg)

+ $\text{Avg.dist}(k) = \sqrt{Mk + B}$
+ Oil glands might be distributing themselves following **normal diffusion** mechanics
+ The **outliers** for citrus groups usually correspond to hybrids.

---

background-image: url("../../citrus/figs/WR11_CR3228_12B-30-9_L02_frontal_ell_projection.jpg")
background-size: 400px
background-position: 50% 90%

class: inverse, center, middle

# Directional statistics

## Perform statistics directly on a sphere surface

### Most of the citrus are nearly spherical, anyway

---

background-image: url("../../citrus/figs/lambert_equal_area_N.gif")
background-size: 150px
background-position: 98% 1%

## Citrus modeling: Sour orange

![](../../citrus/figs/SR01_CRC3289_12B-19-9_L00_Geocentric.jpg)

```{r, out.width=550, fig.align='center'}
knitr::include_graphics('../../citrus/figs/SR01_CRC3289_12B-19-9_L00_geocentric_lazi.jpg')
```

---

# Citrus projections

![](../../citrus/figs/citrus_comparison_panel_alt.jpg)

---

background-image: url("../../citrus/ellipsoids/GarciaPortugues_etal_2020a.png")
background-size: 200px
background-position: 99% 1%

# Uniform and rotationally symmetric spherical distributions

![](../../citrus/figs/rotasym_comparison_panel_alt.jpg)

- A battery of tests reveal that citrus oil glands are neither uniformly nor rotationally symmetrically distributed.

---

background-image: url("../../citrus/ellipsoids/GarciaPortugues_2013.png")
background-size: 300px
background-position: 99% 3%

## Spherical Kernel Density Estimators

![](../../citrus/figs/WR19_CRC3842_18B-18-5_L00_emi_kde_N.jpg)

- Oil glands of a papeda
- Red arrows indicate the most significant gradient values for the density function
- Concentration parameter $k$ is chosen to be optimal

---

background-image: url("../../citrus/ellipsoids/Vuollo_and_Holmstrom_2018.png")
background-size: 300px
background-position: 95% 3%

# More exploratory analysis

## SphereSiZer

![](../../citrus/figs/P01C_L00_N.gif)

---

# Future directions

.left-column[
![](../../citrus/crc_pics/citrus_amblycarpa.jpg)
![](../../citrus/crc_pics/citrus_hystrix.jpg)
![](../../citrus/crc_pics/citrus_macrophylla.jpg)
]

.right-column[

- Locate, segment, and phenotype seed tissue.

- Explore more on normal diffusion mechanics and their possible relationship to oil gland distribution.

- Define a measure of similarity of oil gland distributions and compute a pairwise distance matrix for all citrus fruits.

- Compare such distances between distributions to phylogenetic distances.

- Explore alternative ellipsoid-to-sphere algorithms to minimize distortion.

]

---

background-image: url("https://bondlsc.missouri.edu/wp-content/uploads/2015/02/sanborn-620x413.jpg")
background-size: 500px
background-position: 50% 95%

class: inverse, center

# 4. Potential future directions

## TDA to bridge the genotype-phenotype gap

## TDA to bridge the biology-mathematics gap

### Mizzou, NextGen, and the IPG have all the resources needed to make sense of data in a high-throughput manner

---

# Comprehensive root phenotyping

.pull-left[

![](https://ipg.missouri.edu/images/facility_images/east_campus.jpeg)

Potential collaborators @ Mizzou

- Felix Fritschi
- David Mendoza-Cozatl
- Jacob Washburn (USDA)

Potential collaborators around MO

- Erin Chambers (SLU)
- Tao Ju (WUSTL)
- Mao Li & Chris Topp (Danforth)

]

.pull-right[
```{r, out.width=225}
knitr::include_graphics(c('../../psd/figs/Maiz_root_Dario.jpeg'))
```
<p style="font-size: 10px; text-align: right; color: Grey;"> Credits: Mendoza-Cozatl</p>

![](https://danzeng8.github.io/personalwebsite/images/pipeline.png)
<p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1186/s13007-021-00829-z">Zeng <em>et al.</em> (2021)</a></p>

]

---

## Fungal network features as functional traits

.pull-left[

![](https://www.slcu.cam.ac.uk/sites/www.slcu.cam.ac.uk/files/styles/leading/public/amfinder-stained_roots-edouard_evangelisti-1.jpg?itok=fBdJLRt7)
<p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://www.slcu.cam.ac.uk/news/new-method-quantify-arbuscular-mycorrhizal-fungi-amf-colonisation-plant-roots">SLCU</a></p>

Quantify arbuscular mycorrhizal fungi (AMF) colonisation patterns of plant roots.

Potential collaborators @ Mizzou

- Heike Buecking
- Gary Stacey

External potential collaborators

- Mason Porter (UCLA)

]

.pull-right[
![](https://oup.silverchair-cdn.com/oup/backfile/Content_public/Journal/comnet/5/1/10.1093_comnet_cnv034/2/cnv03402.jpeg?Expires=1672627121&Signature=QeExxwr4FhzoFGvhV9IV1Q6d2~2dkastJXjkG1AjgcbSl8p2wc3Rghaywb9j~Eoriehlp50t9YttUxm8bdAtqFIwFaWgY~vKjohinbvUy9zvB9m5qi3PpCIqQ47~UeXnTHUV22rf-SsxXMgaHHE~GRlKTVq3jPH3sCyhM4igKcay32hWoWNstt7XbkNTcuHo4RKsNUV-O4YdK4GuJRxFVYJOHfdYQG3A1AYQG9PwY~OQ1qyYiWJlq-X4ZQHypSUy4tH2etuJrNRFua1z4LwpYuWyaxK1PIrJTGv7DFs1T6iB-MY5KE9kYm4sMq4GyTUCDGD-VEClm0MoYv5V8mGSPg__&Key-Pair-Id=APKAIE5G5CRDK6RD3PGA)
<p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1093/comnet/cnv034">Hoon Lee <em>et al.</em> (2017)</a></p>
]


---

# Quantifying the shape of cellular patterns

.pull-left[

![](https://ipg.missouri.edu/Images/facility_images/MCC.jpg)

The **Molecular Cytology Core** at the **Bond Life Science Center** offers state-of-the-art microscopy imaging and resources.

Potential collaborators @ Mizzou

- Ron Mittler
- Melvin Oliver
- Robert Sharp

External potential collaborators

- Pau Formosa-Jordan (MPIPZ)

]

.pull-right[

```{r, out.width=250}
knitr::include_graphics(c('../../psd/figs/pavement_plasma.jpg', '../../psd/figs/bw_pavement_geometry_area.gif'))
```

]

---

# Omics networks also have shape!

.pull-left[

![](https://research.missouri.edu/sites/default/files/featured-img/2021-12/panlabview.jpg)

The **Genomics Technology Core**, the **Gehrke Proteomics Center**, and the **Metabolomics Center** will provide detailed omics network data, from which further structure can be inferred.

Potential collaborators @ MU


- Ruthie Angelovici
- Trupti Joshi
- Andrew Scaboo

]

.pull-right[

![](../../tda/figs/tissue_leaf_lens.png)
<p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1101/2022.09.07.506951">Palande <em>et al.</em> (2022)</a></p>

]

---

# The intricacies of protein shape

.pull-left[

![](https://research.missouri.edu/sites/default/files/featured-img/2022-02/emc-news-announcements-8jpg.jpg)

The **Electron Microscopy Core** at the **NextGen Precision Health building** offers state-of-the-art Cryo-EM resources for protein imaging.

Potential collaborators @ MU

- Jianlin Cheng
- Brian Mooney
- Dong Xu

]

.pull-right[

![](https://journals.plos.org/ploscompbiol/article/figure/image?size=large&id=10.1371/journal.pcbi.1010045.g001)
<p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1371/journal.pcbi.1010045">Tang <em>et al.</em> (2022)</a></p>

![](../../proteins/figs/protein_vr_rsz.gif)
]

---

background-image: url("../../tutorials/figs/PlantsPythonQR.jpg")
background-size: 350px
background-position: 50% 95%

class: inverse, center

# Plants & Python

## Large amounts of data require large amounts of people

## Freely available at [bit.ly/plantspython](https://plantsandpython.github.io/PlantsAndPython/00_Opening_page.html)


---

background-image: url("https://plantsandpython.github.io/PlantsAndPython/_images/plants_python_logo.jpg")
background-size: 180px
background-position: 99% 1%

## Python taught especifically for plant biologists

<p align="center">
<iframe width="800" height="500" src="https://plantsandpython.github.io/PlantsAndPython/00_Opening_page.html" title="Plants and Python">
</iframe>
</p>
<p style="font-size: 8px; text-align: right; color: Grey;"><a href="https://plantsandpython.github.io/PlantsAndPython/00_Opening_page.html">Original link</a></p>

---

background-image: url("../../tutorials/figs/plantspython22_02.png")
background-size: 180px
background-position: 99% 1%

# Hybrid class format

.pull-left[

- Offered in hybrid format between MSU and UNAM

- 3-credit course during Fall semester

- **HRT 841**: Foundation in Computational and Plant Science

- **UNAM Temas Selectos**: Bioinformática y Minería de Datos con Python

- Freely available material in jupyter notebook format.

- Material in English and Spanish.

]

.pull-right[
![](../../tutorials/figs/class_foto1.png)
![](../../tutorials/figs/plantspython22_01.png)
]


---

## Empower students to lead cutting-edge research

.pull-left[
Large amounts of data require large amounts of people

Build off SPIP (Small Plant Imaging Platform) a hands-on class experience.

MU's Engineering and Information Technology Program hosts faculty with advanced pedagogical knowledge and skills to enrich the project.

Potential collaborators @ MU

- Brian Maurer
- Dale Musser
- Jon Stemmle

]

.pull-right[

Plants&Python 2019
```{r, out.width=250}
knitr::include_graphics(c('https://bsapubs.onlinelibrary.wiley.com/cms/asset/d5c10e59-0479-4be0-a19e-fddb0ef49ef0/aps311404-fig-0004-m.jpg'))
```
<p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1002/aps3.11404">Bryson <em>et al.</em> (2020)</a></p>

Plants&Python 2020
```{r, out.width=250}
knitr::include_graphics(c('https://www.biorxiv.org/content/biorxiv/early/2022/09/09/2022.09.07.506951/F1.large.jpg?width=800&height=600&carousel=1'))
```
<p style="font-size: 10px; text-align: right; color: Grey;"> Credits: <a href="https://doi.org/10.1101/2022.09.07.506951">Palande <em>et al.</em> (2022)</a></p>
]

---


background-image: url("../../cmse/figs/institutional_logos.jpg")
background-size: 500px
background-position: 95% 1%

class: inverse

## Thank you!

<div class="row" style="margin-top: -25px;">
  <div class="column" style="max-width:19.5%; font-size: 13px;">
    <img style="padding: 0 0 0 0;" src="https://i1.rgstatic.net/ii/profile.image/607374528233472-1521820780707_Q128/Elizabeth-Munch.jpg">
    <p style="text-align: center; color: White">Liz Munch<br>(MSU)</p>
    <img style="padding: 0 0 0 0;" src="https://alga.win.tue.nl/images/staff/tim.jpg">
    <p style="text-align: center; color: White">Tim Ophelders<br>(Utrecht)</p>
    <img style="padding: 0 0 0 0;" src="https://publons.com/media/thumbs/academic/photos/252a7116-ee14-4a5e-b44c-7c62ac11e217.png.200x200_q95_crop_detail_upscale.png">
    <p style="text-align: center; color: White">Jacob Landis<br>(Cornell)</p>
  </div>
  <div class="column" style="max-width:19.5%; font-size: 13px;">
    <img style="padding: 0 0 0 0;" src="https://directory.natsci.msu.edu/media/Directory/Profiles/dhchitwood20230719102707.jpg">
    <p style="text-align: center; color: White">Dan Chitwood<br>(MSU)</p>
    <img style="padding: 0 0 0 0;" src="https://i1.rgstatic.net/ii/profile.image/926632407748609-1597937790454_Q128/Michelle-Quigley.jpg">
    <p style="text-align: center; color: White">Michelle Quigley<br>(MSU)</p>
    <img style="padding: 0 0 0 0;" src="../../psd/figs/mizzou22.png">
  </div>
  <div class="column" style="max-width:14%; font-size: 13px;">
  <img style="padding: 0 0 0 0;" src="https://plantbiology.ucr.edu/sites/g/files/rcwecm1001/files/styles/scale_225/public/Koenig.jpg?itok=P92Ow61p">
  <p style="text-align: center; color: White">Dan Koenig<br>(UC Riverside)</p>
  <img style="padding: 0 0 0 0;" src="https://iigb.ucr.edu/sites/g/files/rcwecm5716/files/styles/scale_225/public/Seymour.jpg?itok=pnUK_orh">
  <p style="text-align: center; color: White">Danelle Seymour<br>(UC Riverside)</p>
  <p style="text-align: left; color: Yellow; font-size:24px; line-height: 1em;">&larr; Grab &larr; these &larr; slides</p>
  </div>
  <div class="column" style="width:10%; font-size: 24px;">
  </div>
  <div class="column" style="max-width:30%; font-size: 24px; line-height:1.25">
  <p style="text-align: center; color: White"><strong>Email</strong></p>
  <p style="text-align: center; color: Yellow">amezqui3@msu.edu</p>
  <p style="text-align: center; color: White"><strong>Slides</strong></p>
  <p style="text-align: center; color: Yellow">bit.ly/mu_22</p>
  <p style="text-align: center; color: White"><strong>References</strong></p>
  <p style="text-align: center; color: White; font-size: 12px; text-align:left">
    <strong>E.A.</strong> <em>et al.</em> (2022) The shape of aroma: measuring and modeling citrus oil gland distribution. <a href="https://doi.org/10.1002/ppp3.10333" target="_blank">DOI: 10.1002/ppp3.10333</a>
  </p>
  <p style="text-align: center; color: White; font-size: 12px; text-align:left">
    <strong>E.A.</strong> <em>et al.</em> (2021) Measuring hidden phenotype: Quantifying the shape of barley seeds using the Euler Characteristic Transform. <a href="https://doi.org/10.1093/insilicoplants/diab033" target="_blank">DOI: 10.1093/insilicoplants/diab033</a>
  </p>
  <p style="text-align: center; color: White; font-size: 12px; text-align:left">
    VanBuren, R. <em>et al.</em> (2022) Plants & Python: A series of lessons in coding, plant biology, computation, and bioinformatics. <a href="https://doi.org/10.1093/plcell/koac187" target="_blank">DOI: 10.1093/plcell/koac187</a>
  </p>
    <p style="text-align: center; color: White; font-size:15px; line-height:1.1">Slides made in <a href="https://bookdown.org/yihui/rmarkdown/xaringan.html" target="_blank">xaringan</a>.</p>
  </div>
</div>
